<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./assets/css/all.css">
  <link rel="stylesheet" href="./assets/css/pages/signin.css">
  <link rel="stylesheet" href="./assets/css/pages/work.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  <script src="./assets/js/jquery-3.5.1.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TweenMax.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
  <script src="./assets/js/vue.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.6.0/gsap.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">
  <script src="https://apis.google.com/js/platform.js" async defer></script>
  <meta name="google-signin-client_id" content="5123688312-hh38n162r8fqfrd31n2a2hid0q7pk7uf.apps.googleusercontent.com">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.js"
    integrity="sha512-c5JDIvikBZ6tuz+OyaFsHKvuyg+tCug3hf41Vmmd5Yz9H5anj4vZOqlBV5PJoEbBJGFCgKoRT9YAgko4JS6/Qw=="
    crossorigin="anonymous"></script>



  <title>森林展間</title>

</head>

<body>

  <!-- -----header----- -->
  @@include('./compontents/head.html')


  @@include('./compontents/searchbar.html')


  @@include('./compontents/music.html')


  <!-- -----header over----- -->


  <!-- wrapper -->




  <div class="title">
    <h1>Forest</h1>
  </div>


  <div class="back">
    <a href="./homepage.html">
      <img src="./assets/img/Group 188.png" alt="">
    </a>
  </div>


  <div class="container">

    <div class="imgAll">
      <div class="3d"></div>
      <!-- <img src="./assets/img/forest/d4023d0957e0ca269e49e4251bd37ca0.jpg" alt="">
      <img src="./assets/img/forest/c29b92ad839293fcdba8b92673b65a47.jpg" alt="">
      <img src="./assets/img/forest/5cfbc2dbf42f6f7d886e01f71af9ce7f.jpg" alt="">
      <img src="./assets/img/forest/劉巧玲_森之冥想之三.PNG" alt="">
      <img src="./assets/img/forest/64884b2074435fb7ddc96d52bb8812e7.jpg" alt="">
      <img src="./assets/img/forest/5fdf7800df502778bf4f144d74e3570b.jpg" alt="">
      <img src="./assets/img/forest/8d887d3a04f55f2f78cd6e445da6fd0d.jpg" alt="">
      <img src="./assets/img/forest/9ac750b0224a2df9392e5d30f3385e1b.jpg" alt="">
      <img src="./assets/img/forest/2c56eb306595e31efeb4623c830b570c.jpg"" alt=""> -->
    </div>

  </div>


  <!-- button -->

  <ul class="button">
    <li>
      <a href="./universe.html">
        <span></span>
        <p>宇宙</p>
      </a>
    </li>
    <li>
      <a href="./ocean.html">
        <span></span>
        <p>海洋</p>
      </a>
    </li>
    <li>
      <a href="#" style="color: #2E2824;">
        <span></span>
        <p>森林</p>
      </a>
    </li>
    <li>
      <a href="./ground.html">
        <span></span>
        <p>地底</p>
      </a>
    </li>

  </ul>


  <script src="./assets/js/menu.js"></script>
  <script src="./assets/js/loginFB.js"></script>
  <script src="./assets/js/loginGoogle.js"></script>
  <script src='./assets/js/music.js'></script>
  <script src='./assets/js/verify.js'></script>
  <script src='./assets/js/logIn.js'></script>
  <script src="./assets/js/button.js"></script>

  <script>
    // $(window).scroll(doQuery);
    $(document).ready(function () {
      doQuery()
    });

    function doQuery() {
      // axios.get('./test.php').then((res)=>{
      //   console.log(res.data); 
      // })
      // alert();
      $.ajax({
        method: "post",
        url: "./assets/php/front/work_forest.php",
        // data: {
        //     Name: str
        // },
        dataType: "text",
        success: function (response) {
          //更新html內容

          document.getElementsByClassName('imgAll')[0].insertAdjacentHTML('beforeend', response);
        },
        error: function (exception) {
          alert("發生錯誤: " + exception.status);
        }
      });
    };

  </script>

  <script>
    $('.imgAll').on('click', '.collection_img', function () {
      let work_id = $(this).attr('data-id');
      // console.log(work_id);
      url = "moon.html?work_id=" + work_id;
      window.location.href = url;
    });
  </script>
  <script type="module">
    import * as THREE from 'https://cdnjs.cloudflare.com/ajax/libs/three.js/r124/three.module.min.js';

    // import Stats from 'https://threejs.org/examples/jsm/libs/stats.module.js';

    import {
      OrbitControls
    } from 'https://threejs.org/examples/jsm/controls/OrbitControls.js';
    import {
      FBXLoader
    } from 'https://threejs.org/examples/jsm/loaders/FBXLoader.js';

    let camera, scene, renderer, stats;
    // let camera2, scene2, renderer2, stats2;


    const clock = new THREE.Clock();

    let mixer;


    init();
    // init_2();
    animate();

    function init() {

      const container = document.createElement('div');
      document.body.appendChild(container);

      camera = new THREE.PerspectiveCamera(35, window.innerWidth / window.innerHeight, 1, 2000);
      // camera.position.set(3, 0.5, -2);
      camera.position.set(3, 2, -5);

      // camera.lookAt(1, 1, 1);
      camera.lookAt(1, 1, 1,);


      scene = new THREE.Scene();
      scene.background = new THREE.Color('#FFFFFF');
      scene.fog = new THREE.Fog('#FFFFFF', 200, 1000);

      const hemiLight = new THREE.HemisphereLight(0xffffff, 0x444444);
      hemiLight.position.set(0, 2000, 0);
      scene.add(hemiLight);

      const dirLight = new THREE.DirectionalLight(0xffffff);
      dirLight.position.set(20, 20, 10);
      dirLight.castShadow = true;
      dirLight.shadow.camera.top = 180;
      dirLight.shadow.camera.bottom = -100;
      dirLight.shadow.camera.left = -120;
      dirLight.shadow.camera.right = 120;
      scene.add(dirLight);

      // scene.add( new THREE.CameraHelper( dirLight.shadow.camera ) );

      // ground
      // const mesh = new THREE.Mesh(new THREE.PlaneBufferGeometry(2000, 2000), new THREE.MeshPhongMaterial({
      //   // color: 0x2E2824,
      //   // color: '#2e2725',
      //   depthWrite: false
      // }));
      // mesh.rotation.x = -Math.PI / 5;
      // mesh.receiveShadow = true;
      // scene.add(mesh);

      // const grid = new THREE.GridHelper(200, 20, 0x000000, 0x000000);
      // grid.material.opacity = 0.2;
      // grid.material.transparent = true;
      // scene.add(grid);



      // model
      var threed = document.getElementsByClassName('3d')[0];
      console.log(threed);
      const loader = new FBXLoader();
      loader.load('../3d/Tree.fbx', function (object) {

        //中心點
        object.children[0].geometry.computeBoundingBox();

        object.rotation.x = THREE.Math.degToRad(0);
        object.rotation.y = THREE.Math.degToRad(0);
        object.rotation.z = THREE.Math.degToRad(0);
        console.log(- (object.children[0].geometry.boundingBox.max.x + object.children[0].geometry.boundingBox.min.x) / 2);
        console.log(- (object.children[0].geometry.boundingBox.max.y + object.children[0].geometry.boundingBox.min.y) / 2);
        console.log(- (object.children[0].geometry.boundingBox.max.z + object.children[0].geometry.boundingBox.min.z) / 2);
        console.log(object.children[0].geometry.center());
        // window.addEventListener('resize', function () {
        // 	player.setSize(window.innerWidth, window.innerHeight);
        // });

        // var player = new APP.Player();
        // player.load(JSON.parse(object));
        // player.setSize(window.innerWidth, window.innerWidth);
        // player.play();

        // document.getElementsByClassName("3d")[0].appendChild(player.dom);
        // mixer = new THREE.AnimationMixer(object);

        // const action = mixer.clipAction(object.animations[0]);
        // let action = mixer.clipAction((obj as any).animations[0]);
        // action.play();

        // object.traverse(function(child) {

        //     if (child.isMesh) {

        //         child.castShadow = true;
        //         child.receiveShadow = true;

        //     }

        // });


        scene.add(object);

      });


      renderer = new THREE.WebGLRenderer({
        antialias: true
      });
      renderer.setPixelRatio(window.devicePixelRatio);
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.shadowMap.enabled = true;
      container.appendChild(renderer.domElement);

      const controls = new OrbitControls(camera, renderer.domElement);
      controls.target.set(0, 0, 0);
      controls.update();

      window.addEventListener('resize', onWindowResize, false);

      // stats
      // current.stats = new Stats();
      // container.appendChild(current.stats.dom);

      var canvas = document.getElementsByTagName('canvas')[0];
      threed.appendChild(canvas);

    }







    function onWindowResize() {

      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();

      renderer.setSize(window.innerWidth, window.innerHeight);

    }

    //

    function animate() {

      requestAnimationFrame(animate);

      const delta = clock.getDelta();

      if (mixer) mixer.update(delta);

      renderer.render(scene, camera);
      // current.renderer.render(current.scene, camera);

      // current.stats.update();

    }

  </script>


</body>

</html>